"use strict";if("undefined"!=typeof module&&null!==module&&"undefined"!==eval("typeof require")&&null!==eval("require")&&"main"in eval("require")&&"undefined"!==eval("typeof require.main")&&null!==eval("require.main")){var ORIGINAL_MAIN_MODULE=module;module!==eval("require.main")&&"paths"in module&&"paths"in eval("require.main")&&"undefined"!=typeof __dirname&&null!==__dirname&&(module.paths=eval("require.main.paths").concat(module.paths.filter((function(path){return eval("require.main.paths").includes(path)}))))}if(null==window)var window="undefined"==typeof global||null===global?{}:global;!function(e,r){if("object"==typeof exports&&"object"==typeof module)module.exports=r(require("@babel/runtime/helpers/extends"),require("@babel/runtime/helpers/asyncToGenerator"),require("@babel/runtime/regenerator"),require("child_process"),require("clientnode"),require("path"),require("rimraf"));else if("function"==typeof define&&define.amd)define(["@babel/runtime/helpers/extends","@babel/runtime/helpers/asyncToGenerator","@babel/runtime/regenerator","child_process","clientnode","path","rimraf"],r);else{var t="object"==typeof exports?r(require("@babel/runtime/helpers/extends"),require("@babel/runtime/helpers/asyncToGenerator"),require("@babel/runtime/regenerator"),require("child_process"),require("clientnode"),require("path"),require("rimraf")):r(e["@babel/runtime/helpers/extends"],e["@babel/runtime/helpers/asyncToGenerator"],e["@babel/runtime/regenerator"],e.child_process,e.clientnode,e.path,e.rimraf);for(var n in t)("object"==typeof exports?exports:e)[n]=t[n]}}(this,((e,r,t,n,a,i,o)=>(()=>{var u=[,r=>{r.exports=e},e=>{e.exports=r},e=>{e.exports=t},e=>{e.exports=n},e=>{e.exports=a},e=>{e.exports=i},e=>{e.exports=o}],c={};function s(e){var r=c[e];if(void 0!==r)return r.exports;var t=c[e]={exports:{}};return u[e](t,t.exports,s),t.exports}s.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return s.d(r,{a:r}),r},s.d=(e,r)=>{for(var t in r)s.o(r,t)&&!s.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})},s.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var l={};return(()=>{s.r(l),s.d(l,{PreRender:()=>b,default:()=>h});var e=s(1),r=s.n(e),t=s(2),n=s.n(t),a=s(3),i=s.n(a),o=s(4),u=s(5),c=s.n(u),d=s(6),p=s.n(d),f=s(7);function m(e,r){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(t)return(t=t.call(e)).next.bind(t);if(Array.isArray(e)||(t=function(e,r){if(e){if("string"==typeof e)return v(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?v(e,r):void 0}}(e))||r&&e&&"number"==typeof e.length){t&&(e=t);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function v(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=Array(r);t<r;t++)n[t]=e[t];return n}var b=function(){function e(){}return e.postConfigurationHotLoaded=function(){var e=n()(i().mark((function e(r){var t,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==(t=r.configuration.preRender)||!t.renderAfterConfigurationUpdates||null==(n=r.services.preRender)||!n.render){e.next=3;break}return e.next=3,r.services.preRender.render(r);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.preLoadService=function(){var r=n()(i().mark((function r(t){var n,a;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=t.configuration.preRender,(a=t.services).preRender={getPrerenderedOutputDirectories:e.getPrerenderedOutputDirectories.bind(e),getPrerendererExecuter:e.getPrerendererExecuter.bind(e),render:e.render.bind(e),renderFile:e.renderFile.bind(e)},!n.renderAfterConfigurationUpdates){r.next=5;break}return r.next=5,a.preRender.render(t);case 5:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),e.shouldExit=function(){var e=n()(i().mark((function e(r){var t,n,a,o,u,c,s,l,d;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.configuration,a=r.pluginAPI,o=r.plugins,u=r.services,null!=(t=u.preRender)&&t.getPrerenderedOutputDirectories){e.next=3;break}return e.abrupt("return");case 3:return c=[],e.t0=m,e.next=7,u.preRender.getPrerenderedOutputDirectories(n,o,a);case 7:e.t1=e.sent,s=(0,e.t0)(e.t1);case 9:if((l=s()).done){e.next=14;break}d=l.value,c.push((0,f.rimraf)(d.path).then((function(){})));case 12:e.next=9;break;case 14:return e.next=16,Promise.all(c);case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.getPrerenderedOutputDirectories=function(){var r=n()(i().mark((function r(t,n,a){var o,u,s,l,d,f,v;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=[].concat(t.preRender.locations.output.directoryNames),u=[].concat(t.preRender.locations.output.exclude),r.next=4,e.getPrerendererExecuter(t,n,a);case 4:s=r.sent.map((function(e){return p().dirname(e.path)})),l=[],d=i().mark((function(){var e;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return e=v.value,r.t0=l,r.next=4,c().walkDirectoryRecursively(e,(function(r){if(r.name.startsWith(".")||u.some((function(t){return r.path.startsWith(p().resolve(e,t))})))return!1}));case 4:r.t1=r.sent.filter((function(e){var r;return!(!(null==(r=e.stats)?void 0:r.isDirectory())||0!==o.length&&!o.includes(e.name))})),r.t0.concat.call(r.t0,r.t1);case 6:case"end":return r.stop()}}),d)})),f=m(s);case 8:if((v=f()).done){r.next=12;break}return r.delegateYield(d(),"t0",10);case 10:r.next=8;break;case 12:return r.abrupt("return",l);case 13:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),e.getPrerendererExecuter=function(){var e=n()(i().mark((function e(r,t,n){var a,o,u,s,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=[].concat(r.preRender.locations.executer.fileNames),o=[],u=m(n.determineLocations(r,r.preRender.locations.executer.include));case 3:if((s=u()).done){e.next=10;break}return l=s.value,e.next=7,c().walkDirectoryRecursively(l,(function(e){if(e.name.startsWith(".")||n.isInLocations(r,t,e.path,r.preRender.locations.executer.exclude))return!1}));case 7:e.sent.map((function(e){var r;null!=(r=e.stats)&&r.isFile()&&a.includes(p().basename(e.name))&&o.push(e)}));case 8:e.next=3;break;case 10:return e.abrupt("return",o);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.render=function(){var t=n()(i().mark((function t(n){var a,o,u,c,s,l,d,p,f,v;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=n.configuration,u=n.pluginAPI,c=n.plugins,s=[].concat(null!==(a=n.data)&&void 0!==a?a:[]),t.t0=u,t.t1=r(),t.t2={},t.t3=n,t.next=8,e.getPrerendererExecuter(o,c,u);case 8:return t.t4=t.sent,t.t5={data:t.t4,hook:"prePreRendererRender"},t.t6=(0,t.t1)(t.t2,t.t3,t.t5),t.next=13,t.t0.callStack.call(t.t0,t.t6);case 13:l=t.sent,d=[],p=m(l);case 16:if((f=p()).done){t.next=30;break}return v=f.value,t.t7=d,t.t8=e,t.t9=v.path,t.t10=[],t.next=24,u.callStack(r()({},n,{hook:"prePreRendererCLIParameter",data:{file:v,parameters:[].concat(s,o.preRender.cache+"")}}));case 24:t.t11=t.sent,t.t12=t.t10.concat.call(t.t10,t.t11),t.t13=t.t8.renderFile.call(t.t8,t.t9,t.t12),t.t7.push.call(t.t7,t.t13);case 28:t.next=16;break;case 30:return t.next=32,Promise.all(d);case 32:return t.next=34,u.callStack(r()({},n,{data:l,hook:"postPreRendererRender"}));case 34:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),e.renderFile=function(e,r){return void 0===r&&(r=[]),new Promise((function(t,n){for(var a,i,s=(0,o.spawn)(e,r,{cwd:p().dirname(e),env:process.env,shell:!0,stdio:"inherit"}),l=m(u.CloseEventNames);!(a=l()).done;)i=a.value,s.on(i,c().getProcessCloseHandler(t,n))}))},e}();const h=b})(),l})()));