'use strict';if(typeof module!=='undefined'&&module!==null&&eval('typeof require')!=='undefined'&&eval('require')!==null&&'main'in eval('require')&&eval('typeof require.main')!=='undefined'&&eval('require.main')!==null){var ORIGINAL_MAIN_MODULE=module;if(module!==eval('require.main')&&'paths'in module&&'paths'in eval('require.main')&&typeof __dirname!=='undefined'&&__dirname!==null)module.paths=eval('require.main.paths').concat(module.paths.filter(function(path){return eval('require.main.paths').includes(path)}))};if(typeof window==='undefined'||window===null)var window=(typeof global==='undefined'||global===null)?{}:global;!function(e,r){if("object"==typeof exports&&"object"==typeof module)module.exports=r(require("@babel/runtime/helpers/extends"),require("@babel/runtime/helpers/asyncToGenerator"),require("@babel/runtime/regenerator"),require("child_process"),require("clientnode"),require("path"),require("rimraf"));else if("function"==typeof define&&define.amd)define(["@babel/runtime/helpers/extends","@babel/runtime/helpers/asyncToGenerator","@babel/runtime/regenerator","child_process","clientnode","path","rimraf"],r);else{var t="object"==typeof exports?r(require("@babel/runtime/helpers/extends"),require("@babel/runtime/helpers/asyncToGenerator"),require("@babel/runtime/regenerator"),require("child_process"),require("clientnode"),require("path"),require("rimraf")):r(e["@babel/runtime/helpers/extends"],e["@babel/runtime/helpers/asyncToGenerator"],e["@babel/runtime/regenerator"],e.child_process,e.clientnode,e.path,e.rimraf);for(var n in t)("object"==typeof exports?exports:e)[n]=t[n]}}(this,((e,r,t,n,a,o,i)=>(()=>{"use strict";var u=[,r=>{r.exports=e},e=>{e.exports=r},e=>{e.exports=t},e=>{e.exports=n},e=>{e.exports=a},e=>{e.exports=o},e=>{e.exports=i}],c={};function s(e){var r=c[e];if(void 0!==r)return r.exports;var t=c[e]={exports:{}};return u[e](t,t.exports,s),t.exports}s.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return s.d(r,{a:r}),r},s.d=(e,r)=>{for(var t in r)s.o(r,t)&&!s.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})},s.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var l={};return(()=>{s.r(l),s.d(l,{PreRender:()=>m,default:()=>h});var e=s(1),r=s.n(e),t=s(2),n=s.n(t),a=s(3),o=s.n(a),i=s(4),u=s(5),c=s.n(u),p=s(6),d=s.n(p),f=s(7),b=s.n(f);function v(e,r){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(t)return(t=t.call(e)).next.bind(t);if(Array.isArray(e)||(t=function(e,r){if(e){if("string"==typeof e)return x(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?x(e,r):void 0}}(e))||r&&e&&"number"==typeof e.length){t&&(e=t);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function x(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=Array(r);t<r;t++)n[t]=e[t];return n}var m=function(){function e(){}return e.postConfigurationHotLoaded=function(){var e=n()(o().mark((function e(r){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==(t=r.configuration.preRender)||!t.renderAfterConfigurationUpdates||null==(n=r.services.preRender)||!n.render){e.next=3;break}return e.next=3,r.services.preRender.render(r);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.preLoadService=function(){var r=n()(o().mark((function r(t){var n,a;return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=t.configuration.preRender,(a=t.services).preRender={getPrerenderedOutputDirectories:e.getPrerenderedOutputDirectories.bind(e),getPrerendererExecuter:e.getPrerendererExecuter.bind(e),render:e.render.bind(e),renderFile:e.renderFile.bind(e)},!n.renderAfterConfigurationUpdates){r.next=5;break}return r.next=5,a.preRender.render(t);case 5:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),e.shouldExit=function(){var e=n()(o().mark((function e(r){var t,n,a,i,u,c,s,l,p;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.configuration,a=r.pluginAPI,i=r.plugins,u=r.services,null!=(t=u.preRender)&&t.getPrerenderedOutputDirectories){e.next=3;break}return e.abrupt("return");case 3:return c=[],s=function(){var e=p.value;c.push(new Promise((function(r,t){return b()(e.path,{glob:!1},(function(e){return e?t(e):r()}))})))},e.t0=v,e.next=8,u.preRender.getPrerenderedOutputDirectories(n,i,a);case 8:e.t1=e.sent,l=(0,e.t0)(e.t1);case 10:if((p=l()).done){e.next=14;break}s();case 12:e.next=10;break;case 14:return e.next=16,Promise.all(c);case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.getPrerenderedOutputDirectories=function(){var r=n()(o().mark((function r(t,n,a){var i,u,s,l,p,f,b;return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i=[].concat(t.preRender.locations.output.directoryNames),u=[].concat(t.preRender.locations.output.exclude),r.next=4,e.getPrerendererExecuter(t,n,a);case 4:s=r.sent.map((function(e){return d().dirname(e.path)})),l=[],p=o().mark((function(){var e;return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return e=b.value,r.t0=l,r.next=4,c().walkDirectoryRecursively(e,(function(r){if(r.name.startsWith(".")||u.some((function(t){return r.path.startsWith(d().resolve(e,t))})))return!1}));case 4:r.t1=r.sent.filter((function(e){var r;return!(!(null==(r=e.stats)?void 0:r.isDirectory())||0!==i.length&&!i.includes(e.name))})),r.t0.concat.call(r.t0,r.t1);case 6:case"end":return r.stop()}}),p)})),f=v(s);case 8:if((b=f()).done){r.next=12;break}return r.delegateYield(p(),"t0",10);case 10:r.next=8;break;case 12:return r.abrupt("return",l);case 13:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),e.getPrerendererExecuter=function(){var e=n()(o().mark((function e(r,t,n){var a,i,u,s,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=[].concat(r.preRender.locations.executer.fileNames),i=[],u=v(n.determineLocations(r,r.preRender.locations.executer.include));case 3:if((s=u()).done){e.next=10;break}return l=s.value,e.next=7,c().walkDirectoryRecursively(l,(function(e){if(e.name.startsWith(".")||n.isInLocations(r,t,e.path,r.preRender.locations.executer.exclude))return!1}));case 7:e.sent.map((function(e){var r;null!=(r=e.stats)&&r.isFile()&&a.includes(d().basename(e.name))&&i.push(e)}));case 8:e.next=3;break;case 10:return e.abrupt("return",i);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.render=function(){var t=n()(o().mark((function t(n){var a,i,u,c,s,l,p,d,f,b;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=n.configuration,u=n.pluginAPI,c=n.plugins,s=[].concat(null!==(a=n.data)&&void 0!==a?a:[]),t.t0=u,t.t1=r(),t.t2={},t.t3=n,t.next=8,e.getPrerendererExecuter(i,c,u);case 8:return t.t4=t.sent,t.t5={data:t.t4,hook:"prePreRendererRender"},t.t6=(0,t.t1)(t.t2,t.t3,t.t5),t.next=13,t.t0.callStack.call(t.t0,t.t6);case 13:l=t.sent,p=[],d=v(l);case 16:if((f=d()).done){t.next=30;break}return b=f.value,t.t7=p,t.t8=e,t.t9=b.path,t.t10=[],t.next=24,u.callStack(r()({},n,{hook:"prePreRendererCLIParameter",data:{file:b,parameters:[].concat(s,i.preRender.cache+"")}}));case 24:t.t11=t.sent,t.t12=t.t10.concat.call(t.t10,t.t11),t.t13=t.t8.renderFile.call(t.t8,t.t9,t.t12),t.t7.push.call(t.t7,t.t13);case 28:t.next=16;break;case 30:return t.next=32,Promise.all(p);case 32:return t.next=34,u.callStack(r()({},n,{data:l,hook:"postPreRendererRender"}));case 34:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),e.renderFile=function(e,r){return void 0===r&&(r=[]),new Promise((function(t,n){for(var a,o,s=(0,i.spawn)(e,r,{cwd:d().dirname(e),env:process.env,shell:!0,stdio:"inherit"}),l=v(u.CloseEventNames);!(a=l()).done;)o=a.value,s.on(o,c().getProcessCloseHandler(t,n))}))},e}();const h=m})(),l})()));